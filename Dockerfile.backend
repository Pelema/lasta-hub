ARG KAFKA_BROKER_HOST

FROM node:20-slim

ENV KAFKA_BROKER_HOST=${KAFKA_BROKER_HOST}

WORKDIR /app

COPY ./server/package*.json ./

RUN npm install

RUN npm install -g coffeescript

COPY ./server ./

EXPOSE 4931

CMD ["coffee", "pdu.coffee"]